### 静态库

> 自转自[Linux基础——gcc编译、静态库与动态库（共享库）](https://blog.csdn.net/daidaihema/article/details/80902012)

**1、静态库的命名格式**
lib + 库的名字 + .a
例：libMyTest.a (MyTest为静态库的名字）

**2、静态库作用分析**
在项目开发过程中，经常出现优秀代码重用现象，又或者提供给第三方功能模块却又不想让其看到源代码，这些时候，通常的做法是将代码封装成库或者框架，生成的静态库要和头文件同时发布。

**优点：**

- 寻址方便，速度快
- 库在链接时被打包到可执行文件中，直接发布可执行程序即可以使用

**缺点：**

- 静态库的代码被加载到可执行程序中，因此体积过大
- 如果静态库的函数发生改变，必须重新编译可执行程序

**3、静态库的制作与使用**
![这里写图片描述](pics/70)

测试代码的目录结构如上图所示，include中存放的是头文件，lib中存放的是静态（动态）库，src中存放的是源代码，main.c是发布代码。

**第一步：得到\*.o文件**

```
gcc *.c -c -I../include1
```

![这里写图片描述](pics/71)

**第二步：创建静态库**

```
ar rcs libMyTest.a *.o        将所有.o文件打包为静态库，r将文件插入静态库中，c创建静态库，不管库是否存在，s写入一个目标文件索引到库中，或者更新一个存在的目标文件索引。
mv libMyTest.a ../lib         将静态库文件放置lib文件夹下
nm libMyTest.a                查看库中包含的函数等信息123
```

![这里写图片描述](pics/72)

**第三步：使用静态库**

```shell
第一种方法：
gcc + 源文件 + -L 静态库路径 + -l静态库名 + -I头文件目录 + -o 可执行文件名
其中L: lib l:静态库文件夹中具体的库名, 以为一个静态库文件夹有不止一个静态库 I:include
gcc main.c -L lib -l MyTest -I include -o app
./app

第二种方法：
gcc + 源文件 + -I头文件 + libxxx.a + -o 可执行文件名
即直接把.a文件丢给gcc处理
gcc main.c -I include lib/libMyTest.a -o app
```

